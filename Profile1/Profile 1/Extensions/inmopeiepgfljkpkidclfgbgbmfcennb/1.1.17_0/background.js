"use strict";(()=>{var Je=Object.create;var ge=Object.defineProperty;var Ze=Object.getOwnPropertyDescriptor;var Qe=Object.getOwnPropertyNames;var et=Object.getPrototypeOf,tt=Object.prototype.hasOwnProperty;var ee=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var rt=(r,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let n of Qe(e))!tt.call(r,n)&&n!==t&&ge(r,n,{get:()=>e[n],enumerable:!(i=Ze(e,n))||i.enumerable});return r};var it=(r,e,t)=>(t=r!=null?Je(et(r)):{},rt(e||!r||!r.__esModule?ge(t,"default",{value:r,enumerable:!0}):t,r));var Ue=ee(j=>{"use strict";j.byteLength=st;j.toByteArray=ct;j.fromByteArray=pt;var x=[],E=[],ot=typeof Uint8Array<"u"?Uint8Array:Array,re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(U=0,Be=re.length;U<Be;++U)x[U]=re[U],E[re.charCodeAt(U)]=U;var U,Be;E[45]=62;E[95]=63;function Te(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var i=t===e?0:4-t%4;return[t,i]}function st(r){var e=Te(r),t=e[0],i=e[1];return(t+i)*3/4-i}function at(r,e,t){return(e+t)*3/4-t}function ct(r){var e,t=Te(r),i=t[0],n=t[1],o=new ot(at(r,i,n)),s=0,u=n>0?i-4:i,h;for(h=0;h<u;h+=4)e=E[r.charCodeAt(h)]<<18|E[r.charCodeAt(h+1)]<<12|E[r.charCodeAt(h+2)]<<6|E[r.charCodeAt(h+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return n===2&&(e=E[r.charCodeAt(h)]<<2|E[r.charCodeAt(h+1)]>>4,o[s++]=e&255),n===1&&(e=E[r.charCodeAt(h)]<<10|E[r.charCodeAt(h+1)]<<4|E[r.charCodeAt(h+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function ut(r){return x[r>>18&63]+x[r>>12&63]+x[r>>6&63]+x[r&63]}function ht(r,e,t){for(var i,n=[],o=e;o<t;o+=3)i=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),n.push(ut(i));return n.join("")}function pt(r){for(var e,t=r.length,i=t%3,n=[],o=16383,s=0,u=t-i;s<u;s+=o)n.push(ht(r,s,s+o>u?u:s+o));return i===1?(e=r[t-1],n.push(x[e>>2]+x[e<<4&63]+"==")):i===2&&(e=(r[t-2]<<8)+r[t-1],n.push(x[e>>10]+x[e>>4&63]+x[e<<2&63]+"=")),n.join("")}});var _e=ee(ie=>{ie.read=function(r,e,t,i,n){var o,s,u=n*8-i-1,h=(1<<u)-1,l=h>>1,p=-7,c=t?n-1:0,w=t?-1:1,y=r[e+c];for(c+=w,o=y&(1<<-p)-1,y>>=-p,p+=u;p>0;o=o*256+r[e+c],c+=w,p-=8);for(s=o&(1<<-p)-1,o>>=-p,p+=i;p>0;s=s*256+r[e+c],c+=w,p-=8);if(o===0)o=1-l;else{if(o===h)return s?NaN:(y?-1:1)*(1/0);s=s+Math.pow(2,i),o=o-l}return(y?-1:1)*s*Math.pow(2,o-i)};ie.write=function(r,e,t,i,n,o){var s,u,h,l=o*8-n-1,p=(1<<l)-1,c=p>>1,w=n===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=i?0:o-1,T=i?1:-1,D=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(u=isNaN(e)?1:0,s=p):(s=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-s))<1&&(s--,h*=2),s+c>=1?e+=w/h:e+=w*Math.pow(2,1-c),e*h>=2&&(s++,h/=2),s+c>=p?(u=0,s=p):s+c>=1?(u=(e*h-1)*Math.pow(2,n),s=s+c):(u=e*Math.pow(2,c-1)*Math.pow(2,n),s=0));n>=8;r[t+y]=u&255,y+=T,u/=256,n-=8);for(s=s<<n|u,l+=n;l>0;r[t+y]=s&255,y+=T,s/=256,l-=8);r[t+y-T]|=D*128}});var ve=ee(C=>{"use strict";var ne=Ue(),N=_e(),Fe=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;C.Buffer=a;C.SlowBuffer=yt;C.INSPECT_MAX_BYTES=50;var K=2147483647;C.kMaxLength=K;a.TYPED_ARRAY_SUPPORT=lt();!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function lt(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}});Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function A(r){if(r>K)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,a.prototype),e}function a(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return ce(r)}return Ce(r,e,t)}a.poolSize=8192;function Ce(r,e,t){if(typeof r=="string")return mt(r,e);if(ArrayBuffer.isView(r))return dt(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(I(r,ArrayBuffer)||r&&I(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(I(r,SharedArrayBuffer)||r&&I(r.buffer,SharedArrayBuffer)))return se(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let i=r.valueOf&&r.valueOf();if(i!=null&&i!==r)return a.from(i,e,t);let n=gt(r);if(n)return n;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return a.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}a.from=function(r,e,t){return Ce(r,e,t)};Object.setPrototypeOf(a.prototype,Uint8Array.prototype);Object.setPrototypeOf(a,Uint8Array);function Pe(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function ft(r,e,t){return Pe(r),r<=0?A(r):e!==void 0?typeof t=="string"?A(r).fill(e,t):A(r).fill(e):A(r)}a.alloc=function(r,e,t){return ft(r,e,t)};function ce(r){return Pe(r),A(r<0?0:ue(r)|0)}a.allocUnsafe=function(r){return ce(r)};a.allocUnsafeSlow=function(r){return ce(r)};function mt(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=Me(r,e)|0,i=A(t),n=i.write(r,e);return n!==t&&(i=i.slice(0,n)),i}function oe(r){let e=r.length<0?0:ue(r.length)|0,t=A(e);for(let i=0;i<e;i+=1)t[i]=r[i]&255;return t}function dt(r){if(I(r,Uint8Array)){let e=new Uint8Array(r);return se(e.buffer,e.byteOffset,e.byteLength)}return oe(r)}function se(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let i;return e===void 0&&t===void 0?i=new Uint8Array(r):t===void 0?i=new Uint8Array(r,e):i=new Uint8Array(r,e,t),Object.setPrototypeOf(i,a.prototype),i}function gt(r){if(a.isBuffer(r)){let e=ue(r.length)|0,t=A(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||pe(r.length)?A(0):oe(r);if(r.type==="Buffer"&&Array.isArray(r.data))return oe(r.data)}function ue(r){if(r>=K)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+K.toString(16)+" bytes");return r|0}function yt(r){return+r!=r&&(r=0),a.alloc(+r)}a.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==a.prototype};a.compare=function(e,t){if(I(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),I(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(e)||!a.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let i=e.length,n=t.length;for(let o=0,s=Math.min(i,n);o<s;++o)if(e[o]!==t[o]){i=e[o],n=t[o];break}return i<n?-1:n<i?1:0};a.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};a.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return a.alloc(0);let i;if(t===void 0)for(t=0,i=0;i<e.length;++i)t+=e[i].length;let n=a.allocUnsafe(t),o=0;for(i=0;i<e.length;++i){let s=e[i];if(I(s,Uint8Array))o+s.length>n.length?(a.isBuffer(s)||(s=a.from(s)),s.copy(n,o)):Uint8Array.prototype.set.call(n,s,o);else if(a.isBuffer(s))s.copy(n,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return n};function Me(r,e){if(a.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||I(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,i=arguments.length>2&&arguments[2]===!0;if(!i&&t===0)return 0;let n=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return ae(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Ve(r).length;default:if(n)return i?-1:ae(r).length;e=(""+e).toLowerCase(),n=!0}}a.byteLength=Me;function Et(r,e,t){let i=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return _t(this,e,t);case"utf8":case"utf-8":return De(this,e,t);case"ascii":return Tt(this,e,t);case"latin1":case"binary":return Ut(this,e,t);case"base64":return At(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ft(this,e,t);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),i=!0}}a.prototype._isBuffer=!0;function _(r,e,t){let i=r[e];r[e]=r[t],r[t]=i}a.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)_(this,t,t+1);return this};a.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)_(this,t,t+3),_(this,t+1,t+2);return this};a.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)_(this,t,t+7),_(this,t+1,t+6),_(this,t+2,t+5),_(this,t+3,t+4);return this};a.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?De(this,0,e):Et.apply(this,arguments)};a.prototype.toLocaleString=a.prototype.toString;a.prototype.equals=function(e){if(!a.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:a.compare(this,e)===0};a.prototype.inspect=function(){let e="",t=C.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};Fe&&(a.prototype[Fe]=a.prototype.inspect);a.prototype.compare=function(e,t,i,n,o){if(I(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),i===void 0&&(i=e?e.length:0),n===void 0&&(n=0),o===void 0&&(o=this.length),t<0||i>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=i)return 0;if(n>=o)return-1;if(t>=i)return 1;if(t>>>=0,i>>>=0,n>>>=0,o>>>=0,this===e)return 0;let s=o-n,u=i-t,h=Math.min(s,u),l=this.slice(n,o),p=e.slice(t,i);for(let c=0;c<h;++c)if(l[c]!==p[c]){s=l[c],u=p[c];break}return s<u?-1:u<s?1:0};function Oe(r,e,t,i,n){if(r.length===0)return-1;if(typeof t=="string"?(i=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,pe(t)&&(t=n?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(n)return-1;t=r.length-1}else if(t<0)if(n)t=0;else return-1;if(typeof e=="string"&&(e=a.from(e,i)),a.isBuffer(e))return e.length===0?-1:Se(r,e,t,i,n);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?n?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):Se(r,[e],t,i,n);throw new TypeError("val must be string, number or Buffer")}function Se(r,e,t,i,n){let o=1,s=r.length,u=e.length;if(i!==void 0&&(i=String(i).toLowerCase(),i==="ucs2"||i==="ucs-2"||i==="utf16le"||i==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,u/=2,t/=2}function h(p,c){return o===1?p[c]:p.readUInt16BE(c*o)}let l;if(n){let p=-1;for(l=t;l<s;l++)if(h(r,l)===h(e,p===-1?0:l-p)){if(p===-1&&(p=l),l-p+1===u)return p*o}else p!==-1&&(l-=l-p),p=-1}else for(t+u>s&&(t=s-u),l=t;l>=0;l--){let p=!0;for(let c=0;c<u;c++)if(h(r,l+c)!==h(e,c)){p=!1;break}if(p)return l}return-1}a.prototype.includes=function(e,t,i){return this.indexOf(e,t,i)!==-1};a.prototype.indexOf=function(e,t,i){return Oe(this,e,t,i,!0)};a.prototype.lastIndexOf=function(e,t,i){return Oe(this,e,t,i,!1)};function wt(r,e,t,i){t=Number(t)||0;let n=r.length-t;i?(i=Number(i),i>n&&(i=n)):i=n;let o=e.length;i>o/2&&(i=o/2);let s;for(s=0;s<i;++s){let u=parseInt(e.substr(s*2,2),16);if(pe(u))return s;r[t+s]=u}return s}function xt(r,e,t,i){return Y(ae(e,r.length-t),r,t,i)}function It(r,e,t,i){return Y(Ct(e),r,t,i)}function bt(r,e,t,i){return Y(Ve(e),r,t,i)}function Rt(r,e,t,i){return Y(Pt(e,r.length-t),r,t,i)}a.prototype.write=function(e,t,i,n){if(t===void 0)n="utf8",i=this.length,t=0;else if(i===void 0&&typeof t=="string")n=t,i=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(i)?(i=i>>>0,n===void 0&&(n="utf8")):(n=i,i=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((i===void 0||i>o)&&(i=o),e.length>0&&(i<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");let s=!1;for(;;)switch(n){case"hex":return wt(this,e,t,i);case"utf8":case"utf-8":return xt(this,e,t,i);case"ascii":case"latin1":case"binary":return It(this,e,t,i);case"base64":return bt(this,e,t,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,e,t,i);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}};a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function At(r,e,t){return e===0&&t===r.length?ne.fromByteArray(r):ne.fromByteArray(r.slice(e,t))}function De(r,e,t){t=Math.min(r.length,t);let i=[],n=e;for(;n<t;){let o=r[n],s=null,u=o>239?4:o>223?3:o>191?2:1;if(n+u<=t){let h,l,p,c;switch(u){case 1:o<128&&(s=o);break;case 2:h=r[n+1],(h&192)===128&&(c=(o&31)<<6|h&63,c>127&&(s=c));break;case 3:h=r[n+1],l=r[n+2],(h&192)===128&&(l&192)===128&&(c=(o&15)<<12|(h&63)<<6|l&63,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:h=r[n+1],l=r[n+2],p=r[n+3],(h&192)===128&&(l&192)===128&&(p&192)===128&&(c=(o&15)<<18|(h&63)<<12|(l&63)<<6|p&63,c>65535&&c<1114112&&(s=c))}}s===null?(s=65533,u=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),n+=u}return Bt(i)}var Ne=4096;function Bt(r){let e=r.length;if(e<=Ne)return String.fromCharCode.apply(String,r);let t="",i=0;for(;i<e;)t+=String.fromCharCode.apply(String,r.slice(i,i+=Ne));return t}function Tt(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]&127);return i}function Ut(r,e,t){let i="";t=Math.min(r.length,t);for(let n=e;n<t;++n)i+=String.fromCharCode(r[n]);return i}function _t(r,e,t){let i=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>i)&&(t=i);let n="";for(let o=e;o<t;++o)n+=Mt[r[o]];return n}function Ft(r,e,t){let i=r.slice(e,t),n="";for(let o=0;o<i.length-1;o+=2)n+=String.fromCharCode(i[o]+i[o+1]*256);return n}a.prototype.slice=function(e,t){let i=this.length;e=~~e,t=t===void 0?i:~~t,e<0?(e+=i,e<0&&(e=0)):e>i&&(e=i),t<0?(t+=i,t<0&&(t=0)):t>i&&(t=i),t<e&&(t=e);let n=this.subarray(e,t);return Object.setPrototypeOf(n,a.prototype),n};function m(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||m(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return n};a.prototype.readUintBE=a.prototype.readUIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||m(e,t,this.length);let n=this[e+--t],o=1;for(;t>0&&(o*=256);)n+=this[e+--t]*o;return n};a.prototype.readUint8=a.prototype.readUInt8=function(e,t){return e=e>>>0,t||m(e,1,this.length),this[e]};a.prototype.readUint16LE=a.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||m(e,2,this.length),this[e]|this[e+1]<<8};a.prototype.readUint16BE=a.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||m(e,2,this.length),this[e]<<8|this[e+1]};a.prototype.readUint32LE=a.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||m(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};a.prototype.readUint32BE=a.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||m(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};a.prototype.readBigUInt64LE=B(function(e){e=e>>>0,L(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&O(e,this.length-8);let n=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+i*2**24;return BigInt(n)+(BigInt(o)<<BigInt(32))});a.prototype.readBigUInt64BE=B(function(e){e=e>>>0,L(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&O(e,this.length-8);let n=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i;return(BigInt(n)<<BigInt(32))+BigInt(o)});a.prototype.readIntLE=function(e,t,i){e=e>>>0,t=t>>>0,i||m(e,t,this.length);let n=this[e],o=1,s=0;for(;++s<t&&(o*=256);)n+=this[e+s]*o;return o*=128,n>=o&&(n-=Math.pow(2,8*t)),n};a.prototype.readIntBE=function(e,t,i){e=e>>>0,t=t>>>0,i||m(e,t,this.length);let n=t,o=1,s=this[e+--n];for(;n>0&&(o*=256);)s+=this[e+--n]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};a.prototype.readInt8=function(e,t){return e=e>>>0,t||m(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};a.prototype.readInt16LE=function(e,t){e=e>>>0,t||m(e,2,this.length);let i=this[e]|this[e+1]<<8;return i&32768?i|4294901760:i};a.prototype.readInt16BE=function(e,t){e=e>>>0,t||m(e,2,this.length);let i=this[e+1]|this[e]<<8;return i&32768?i|4294901760:i};a.prototype.readInt32LE=function(e,t){return e=e>>>0,t||m(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};a.prototype.readInt32BE=function(e,t){return e=e>>>0,t||m(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};a.prototype.readBigInt64LE=B(function(e){e=e>>>0,L(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&O(e,this.length-8);let n=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(i<<24);return(BigInt(n)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});a.prototype.readBigInt64BE=B(function(e){e=e>>>0,L(e,"offset");let t=this[e],i=this[e+7];(t===void 0||i===void 0)&&O(e,this.length-8);let n=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(n)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+i)});a.prototype.readFloatLE=function(e,t){return e=e>>>0,t||m(e,4,this.length),N.read(this,e,!0,23,4)};a.prototype.readFloatBE=function(e,t){return e=e>>>0,t||m(e,4,this.length),N.read(this,e,!1,23,4)};a.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||m(e,8,this.length),N.read(this,e,!0,52,8)};a.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||m(e,8,this.length),N.read(this,e,!1,52,8)};function g(r,e,t,i,n,o){if(!a.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<o)throw new RangeError('"value" argument is out of bounds');if(t+i>r.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let u=Math.pow(2,8*i)-1;g(this,e,t,i,u,0)}let o=1,s=0;for(this[t]=e&255;++s<i&&(o*=256);)this[t+s]=e/o&255;return t+i};a.prototype.writeUintBE=a.prototype.writeUIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,i=i>>>0,!n){let u=Math.pow(2,8*i)-1;g(this,e,t,i,u,0)}let o=i-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+i};a.prototype.writeUint8=a.prototype.writeUInt8=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,1,255,0),this[t]=e&255,t+1};a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function ke(r,e,t,i,n){He(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function $e(r,e,t,i,n){He(e,i,n,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}a.prototype.writeBigUInt64LE=B(function(e,t=0){return ke(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});a.prototype.writeBigUInt64BE=B(function(e,t=0){return $e(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});a.prototype.writeIntLE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let h=Math.pow(2,8*i-1);g(this,e,t,i,h-1,-h)}let o=0,s=1,u=0;for(this[t]=e&255;++o<i&&(s*=256);)e<0&&u===0&&this[t+o-1]!==0&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+i};a.prototype.writeIntBE=function(e,t,i,n){if(e=+e,t=t>>>0,!n){let h=Math.pow(2,8*i-1);g(this,e,t,i,h-1,-h)}let o=i-1,s=1,u=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&u===0&&this[t+o+1]!==0&&(u=1),this[t+o]=(e/s>>0)-u&255;return t+i};a.prototype.writeInt8=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};a.prototype.writeInt16LE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};a.prototype.writeInt16BE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};a.prototype.writeInt32LE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};a.prototype.writeInt32BE=function(e,t,i){return e=+e,t=t>>>0,i||g(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};a.prototype.writeBigInt64LE=B(function(e,t=0){return ke(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});a.prototype.writeBigInt64BE=B(function(e,t=0){return $e(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function qe(r,e,t,i,n,o){if(t+i>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function We(r,e,t,i,n){return e=+e,t=t>>>0,n||qe(r,e,t,4,34028234663852886e22,-34028234663852886e22),N.write(r,e,t,i,23,4),t+4}a.prototype.writeFloatLE=function(e,t,i){return We(this,e,t,!0,i)};a.prototype.writeFloatBE=function(e,t,i){return We(this,e,t,!1,i)};function Ge(r,e,t,i,n){return e=+e,t=t>>>0,n||qe(r,e,t,8,17976931348623157e292,-17976931348623157e292),N.write(r,e,t,i,52,8),t+8}a.prototype.writeDoubleLE=function(e,t,i){return Ge(this,e,t,!0,i)};a.prototype.writeDoubleBE=function(e,t,i){return Ge(this,e,t,!1,i)};a.prototype.copy=function(e,t,i,n){if(!a.isBuffer(e))throw new TypeError("argument should be a Buffer");if(i||(i=0),!n&&n!==0&&(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<i&&(n=i),n===i||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-i&&(n=e.length-t+i);let o=n-i;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,i,n):Uint8Array.prototype.set.call(e,this.subarray(i,n),t),o};a.prototype.fill=function(e,t,i,n){if(typeof e=="string"){if(typeof t=="string"?(n=t,t=0,i=this.length):typeof i=="string"&&(n=i,i=this.length),n!==void 0&&typeof n!="string")throw new TypeError("encoding must be a string");if(typeof n=="string"&&!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);if(e.length===1){let s=e.charCodeAt(0);(n==="utf8"&&s<128||n==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<i)throw new RangeError("Out of range index");if(i<=t)return this;t=t>>>0,i=i===void 0?this.length:i>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<i;++o)this[o]=e;else{let s=a.isBuffer(e)?e:a.from(e,n),u=s.length;if(u===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<i-t;++o)this[o+t]=s[o%u]}return this};var S={};function he(r,e,t){S[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(n){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:n,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}he("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);he("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);he("ERR_OUT_OF_RANGE",function(r,e,t){let i=`The value of "${r}" is out of range.`,n=t;return Number.isInteger(t)&&Math.abs(t)>2**32?n=Le(String(t)):typeof t=="bigint"&&(n=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(n=Le(n)),n+="n"),i+=` It must be ${e}. Received ${n}`,i},RangeError);function Le(r){let e="",t=r.length,i=r[0]==="-"?1:0;for(;t>=i+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function St(r,e,t){L(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&O(e,r.length-(t+1))}function He(r,e,t,i,n,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",u;throw o>3?e===0||e===BigInt(0)?u=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:u=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:u=`>= ${e}${s} and <= ${t}${s}`,new S.ERR_OUT_OF_RANGE("value",u,r)}St(i,n,o)}function L(r,e){if(typeof r!="number")throw new S.ERR_INVALID_ARG_TYPE(e,"number",r)}function O(r,e,t){throw Math.floor(r)!==r?(L(r,t),new S.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new S.ERR_BUFFER_OUT_OF_BOUNDS:new S.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var Nt=/[^+/0-9A-Za-z-_]/g;function Lt(r){if(r=r.split("=")[0],r=r.trim().replace(Nt,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function ae(r,e){e=e||1/0;let t,i=r.length,n=null,o=[];for(let s=0;s<i;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!n){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===i){(e-=3)>-1&&o.push(239,191,189);continue}n=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),n=t;continue}t=(n-55296<<10|t-56320)+65536}else n&&(e-=3)>-1&&o.push(239,191,189);if(n=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Ct(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Pt(r,e){let t,i,n,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),i=t>>8,n=t%256,o.push(n),o.push(i);return o}function Ve(r){return ne.toByteArray(Lt(r))}function Y(r,e,t,i){let n;for(n=0;n<i&&!(n+t>=e.length||n>=r.length);++n)e[n+t]=r[n];return n}function I(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function pe(r){return r!==r}var Mt=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let i=t*16;for(let n=0;n<16;++n)e[i+n]=r[t]+r[n]}return e}();function B(r){return typeof BigInt>"u"?Ot:r}function Ot(){throw new Error("BigInt not supported")}});var nt={storage:{local:{get:r=>new Promise(e=>{chrome.storage.local.get(r,t=>{e(t[r])})}),set:r=>new Promise(e=>chrome.storage.local.set(r,e)),remove:r=>new Promise(e=>{chrome.storage.local.remove(r,e)})}},runtime:{sendMessage:(r,e)=>chrome.runtime.sendMessage(r,e),getURL:r=>chrome.runtime.getURL(r),onMessage:{addListener:r=>chrome.runtime.onMessage.addListener(r)}}},ye=nt;var Ee;Ee=ye;var F=Ee;var we=r=>String(r).startsWith("chrome://")||String(r).startsWith("chrome-extension://");var $=r=>{let e;return r.indexOf("//")>-1?e=r.split("/")[2]:e=r.split("/")[0],e=e.split(":")[0],e=e.split("?")[0],e};var P=class{constructor(){this.actions=[]}handle(){this.actions.forEach(e=>e.handle())}dispose(){this.actions.forEach(e=>e.dispose()),this.actions=[]}add(e){this.actions.push(e)}getActionOfType(e){return this.actions.find(t=>e.name===t.constructor.name)}},q=class extends P{handle(){return Promise.all(this.actions.map(e=>e.handle()))}dispose(){return Promise.all(this.actions.map(e=>e.dispose()))}};var W=class{constructor(e){this.hostname="";this.screens=new Map;this.actions=new P;this.blockingActions=new q;this.isReady=!1;this.aborted=!1;this.plugins=[];this.data={};this.tab=e,this.hostname=$(e.url)}start(){this.blockingActions.handle().then(()=>{this.actions.handle(),this.reloadApp()})}reloadApp(){chrome.scripting.executeScript({target:{tabId:this.tab.id},func:async()=>{let e=await navigator.serviceWorker.getRegistrations();await Promise.all(e.map(t=>t.unregister())),window.location.reload()}})}dispose(){this.blockingActions.dispose().then(()=>this.actions.dispose())}toJson(){return this.tab}};var b=class{constructor(e,t){this.tab=e,this.contentTypeRuleId=t.generate(),this.frameHeaderRuleId=t.generate()}static resetAll(){chrome.declarativeNetRequest.getSessionRules().then(e=>{chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:e.map(t=>t.id)})})}removeInitialResponseRules(){chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[this.contentTypeRuleId]})}handle(){let e=[...this.getInitialResponseRules(),...this.getFrameRules()];return chrome.declarativeNetRequest.updateSessionRules({addRules:e})}clearInitialRequesRequest(){chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[this.contentTypeRuleId]})}dispose(){return chrome.declarativeNetRequest.updateSessionRules({removeRuleIds:[this.contentTypeRuleId,this.frameHeaderRuleId]})}getInitialResponseRules(){return[{id:this.contentTypeRuleId,priority:1,action:{type:chrome.declarativeNetRequest.RuleActionType.MODIFY_HEADERS,responseHeaders:[{header:"content-type",operation:chrome.declarativeNetRequest.HeaderOperation.SET,value:"image/png"}]},condition:{tabIds:[this.tab.tab.id],resourceTypes:[chrome.declarativeNetRequest.ResourceType.MAIN_FRAME]}}]}getFrameRules(){return[{id:this.frameHeaderRuleId,priority:1,action:{type:chrome.declarativeNetRequest.RuleActionType.MODIFY_HEADERS,responseHeaders:[{header:"x-frame-options",operation:chrome.declarativeNetRequest.HeaderOperation.REMOVE},{header:"content-security-policy",operation:chrome.declarativeNetRequest.HeaderOperation.REMOVE},{header:"frame-options",operation:chrome.declarativeNetRequest.HeaderOperation.REMOVE}]},condition:{tabIds:[this.tab.tab.id],resourceTypes:[chrome.declarativeNetRequest.ResourceType.MAIN_FRAME,chrome.declarativeNetRequest.ResourceType.SUB_FRAME]}}]}};var xe="@RESPONSIVE-VIEWER";var R="https://responsiveviewer.org",cr=`${R}/user/extension`,Ie=`${R}/user/session`,be=`${R}/user/uploads`,Re=`${R}/api/feedback`,te=`${R}/uninstall`,Ae=`${R}/api/install`;var ur=`${R}/login`,hr=`${R}/dashboard`,pr=`${R}/plugins`;var f=(r="",e="")=>{let t=`${xe}${e?"-"+e:""}`;return r.startsWith(t)?r:`${t}/${r}`};var G=class{constructor(e){this.tab=e,this.onBeforeNavigate=this.onBeforeNavigate.bind(this)}handle(){chrome.webNavigation.onCommitted.addListener(this.onBeforeNavigate)}dispose(){chrome.webNavigation.onCommitted.removeListener(this.onBeforeNavigate)}onBeforeNavigate(e){e.tabId===this.tab.tab.id&&(this.frameConnected(e)||(this.frameRefreshed(e.frameId),this.appRefreshed(e.frameId)))}appRefreshed(e){e===0&&(this.tab.isReady||this.tab.blockingActions.getActionOfType(b)?.clearInitialRequesRequest())}frameConnected(e){let{frameId:t,url:i}=e;if(t===0)return;if(!i.startsWith("about:blank?screenId="))return!1;let n=new URL(i).searchParams.get("screenId");return this.tab.screens.set(t,n),chrome.tabs.sendMessage(this.tab.tab.id,{message:f("FRAME_CONNECTED"),frameId:t,screenId:n}),!0}frameRefreshed(e){if(e===0)return;let t=this.tab.screens.get(e);t&&chrome.tabs.sendMessage(this.tab.tab.id,{message:f("FRAME_REFRESHED"),screenId:t})}};var H=class{constructor(e,t){this.tab=e,this.context=t,this.onBeforeRequest=this.onBeforeRequest.bind(this)}handle(){chrome.webRequest.onBeforeRequest.addListener(this.onBeforeRequest,{urls:["<all_urls>"],types:["main_frame"],tabId:this.tab.tab.id})}dispose(){chrome.webRequest.onBeforeRequest.removeListener(this.onBeforeRequest)}onBeforeRequest(e){this.tab.isReady&&this.context.removeTab(this.tab.tab.id)}};var V=class{constructor(e){this.tab=e,this.onErrorOccurred=this.onErrorOccurred.bind(this)}handle(){chrome.webNavigation.onErrorOccurred.addListener(this.onErrorOccurred)}dispose(){chrome.webNavigation.onErrorOccurred.removeListener(this.onErrorOccurred)}onErrorOccurred(e){e.tabId!==this.tab.tab.id||e.frameId!==0||this.tab.dispose()}};var v={},M=class{constructor(e,t){this.tab=e,this.plugin=t}handle(){if(!this.plugin.background)return;let e=F.runtime.getURL(this.plugin.background);v[e]?this.execute(v[e]):fetch(e).then(t=>t.text()).then(t=>{v[e]=t,this.execute(v[e])})}execute(e){chrome.tabs.sendMessage(this.tab.tab.id,{message:f("PLUGIN_SCRIPT_INSTALL"),script:e,plugin:this.plugin})}dispose(){}};var Ke=it(ve()),X=class{constructor(e){this.tab=e,this.onMessage=this.onMessage.bind(this)}handle(){chrome.runtime.onMessage.addListener(this.onMessage)}dispose(){chrome.runtime.onMessage.removeListener(this.onMessage)}onMessage(e,t,i){return!t.tab||!this.tab.tab.id||t.tab.id!==this.tab.tab.id||Dt(e,t,i,this.tab),!0}},Dt=async(r,e,t,i)=>{switch(r.message){case f("GET_TAB_URL"):t({tabUrl:i.tab.url});break;case f("SUBMIT_FEEDBACK"):fetch(Re,{method:"POST",body:JSON.stringify(r.data)}),t({});break;case f("UPLOAD_SCREENSHOT"):let{user:n}=await chrome.storage.local.get("user");if(!n)return;let o=r.screenshots.map(c=>{let w=c.image.split(",");w.shift();let y=w.join(""),T=Ke.Buffer.from(y,"base64"),D=new Uint8Array(T.length);for(let k=0;k<T.length;k++)D[k]=T[k];return new File([D],c.filename,{type:"image/png"})}),s=new FormData;o.forEach((c,w)=>{s.append("file",c)}),fetch(be,{method:"POST",body:s,headers:{Authorization:n.accessToken}}).then(c=>c.json()).then(c=>{t(c)});break;case f("CAPTURE_SCREEN"):let u=await chrome.tabs.captureVisibleTab(i.tab.windowId,{format:"png",quality:1});t({image:u});break;case f("WAIT"):setTimeout(()=>{t({})},r.time);break;case f("LOAD_PLUGINS"):i.plugins=r.plugins,t({});break;case f("PLUGIN_INSTALL"):if(i.plugins.push(r.plugin),r.plugin.background){let c=new M(i,r.plugin);i.actions.add(c),c.handle()}break;case f("PLUGIN_UNINSTALL"):let h=i.plugins.findIndex(c=>c.name===r.plugin.name),l=i.actions.actions.findIndex(c=>c instanceof M&&c.plugin.name===r.plugin.name);i.actions.actions[l].dispose(),i.actions.actions.splice(l,1),i.plugins.splice(h,1);break;case f("CHECK_USER"):{let{user:c}=await chrome.storage.local.get("user");je(c?.accessToken,i,!0,"USER_CHECKED")}break;case f("LOAD_STATE"):let{user:p}=await chrome.storage.local.get("user");setTimeout(()=>{je(p?.accessToken,i)},200),t({extensionURL:chrome.runtime.getURL("").replace(/\/$/,""),user:p});break;case f("PING"):t({pong:!0});break;case f("UPDATE_USER"):await chrome.storage.local.set({user:r.user}),t({ok:!0});break;case f("GET_SCREEN_ID"):t({screenId:i.screens.get(e.frameId),ok:!0});break;default:chrome.tabs.sendMessage(i.tab.id,r,()=>{}),t({});break}},le=0,kt=5,je=async(r,e,t=!1,i)=>{if(le!==0&&!t){let o=Date.now()-le,s=60*1e3;if(o/s<kt)return}let n={isAuthorized:!1,isPremium:!1,accessToken:"",name:"",plan:"Free"};if(r){le=Date.now();try{let o=await fetch(Ie,{headers:{Authorization:r}});if(o.status!==200)throw new Error(`Received status ${o.status} `);n=await o.json()}catch{console.log("Error: auth")}}chrome.tabs.sendMessage(e.tab.id,{message:f(i||"UPDATE_USER"),user:n})};var Ye="__@RESONSIVE_VIEWER_DONT_USE@__";var Xe=(r,e)=>r.filter(t=>t[e]!==void 0);var $t=r=>{r.id&&(chrome.scripting.executeScript({target:{tabId:r.id},files:["/init.js"]}),chrome.scripting.executeScript({target:{tabId:r.id},files:["/main.js"]}))},z=class{constructor(e){this.injected=!1;this.tab=e,this.onWebNavigationComplete=this.onWebNavigationComplete.bind(this)}handle(){chrome.webNavigation.onCommitted.addListener(this.onWebNavigationComplete)}dispose(){chrome.webNavigation.onCommitted.removeListener(this.onWebNavigationComplete)}onWebNavigationComplete(e){this.isValidTab(e.tabId,e.url)&&this.verifyHostname(e.url)&&(this.inject(e.frameId)||this.tab.screens.get(e.frameId)&&chrome.scripting.executeScript({target:{tabId:this.tab.tab.id,frameIds:[e.frameId]},files:["/pluginsApp.js"],injectImmediately:!0,world:"MAIN"}).then(async()=>{let t=this.tab.screens.get(e.frameId);await chrome.scripting.executeScript({target:{tabId:this.tab.tab.id,frameIds:[e.frameId]},func:(n,o)=>{window[o].start(n)},args:[t,Ye],injectImmediately:!0,world:"MAIN"});let i=Xe(this.tab.plugins,"script").map(n=>n.script).filter(Boolean);i.length>0&&chrome.scripting.executeScript({target:{tabId:this.tab.tab.id,frameIds:[e.frameId]},files:i,injectImmediately:!0,world:"MAIN"}),chrome.tabs.sendMessage(this.tab.tab.id,{message:f("FRAME_CONNECTED"),frameId:e.frameId,screenId:t})}))}inject(e){return e!==0||this.injected?!1:(this.injected=!0,$t(this.tab.tab),this.tab.isReady=!0,this.tab.blockingActions.actions.find(i=>i instanceof b)?.removeInitialResponseRules(),!0)}isValidTab(e,t){return this.tab.tab.id===e&&t!=="about:blank"}verifyHostname(e){return $(e)===this.tab.hostname}};var J=class{constructor(){this.lastId=0}generate(){return this.lastId++,this.lastId}};var Z,qt=new Uint8Array(16);function fe(){if(!Z&&(Z=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Z(qt)}var d=[];for(let r=0;r<256;++r)d.push((r+256).toString(16).slice(1));function ze(r,e=0){return(d[r[e+0]]+d[r[e+1]]+d[r[e+2]]+d[r[e+3]]+"-"+d[r[e+4]]+d[r[e+5]]+"-"+d[r[e+6]]+d[r[e+7]]+"-"+d[r[e+8]]+d[r[e+9]]+"-"+d[r[e+10]]+d[r[e+11]]+d[r[e+12]]+d[r[e+13]]+d[r[e+14]]+d[r[e+15]]).toLowerCase()}var Wt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),me={randomUUID:Wt};function Gt(r,e,t){if(me.randomUUID&&!e&&!r)return me.randomUUID();r=r||{};let i=r.random||(r.rng||fe)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,e){t=t||0;for(let n=0;n<16;++n)e[t+n]=i[n];return e}return ze(i)}var de=Gt;var Ht=r=>!!(r.id&&r.url&&!we(r.url)),Q=class{constructor(){this.tabs=new Map;this.idGenerator=new J;this.#e()}reset(){b.resetAll(),this.tabs.forEach(e=>{e.dispose(),chrome.scripting.executeScript({target:{tabId:e.tab.id},func:async()=>{window.location.reload()}})}),this.tabs.clear()}async#e(){this.reset(),chrome.action.onClicked.addListener(e=>{Ht(e)&&(this.removeTab(e.id),this.createTab(e))}),chrome.runtime.onInstalled.addListener(()=>{this.reset()}),chrome.runtime.onSuspend.addListener(()=>{this.reset()}),chrome.tabs.onRemoved.addListener(e=>{this.removeTab(e)}),chrome.runtime.onInstalled.addListener(function(e){chrome.storage.local.get(["SESSION_ID","SESSION_ID_2"]).then(({SESSION_ID:t,SESSION_ID_2:i})=>{t||(t=de(),F.storage.local.set({SESSION_ID:t})),chrome.runtime.setUninstallURL(`${te}?source=${t}&source2=${i}`),e.reason==="install"&&fetch(Ae,{method:"POST",body:JSON.stringify({sessionId:t})}).then(n=>n.json()).then(n=>{F.storage.local.set({SESSION_ID_2:n.id}),chrome.runtime.setUninstallURL(`${te}?source=${t}&source2=${n.id}`)})})})}removeTab(e){this.tabs.has(e)&&(this.tabs.get(e)?.dispose(),this.tabs.delete(e))}createTab(e){let t=new W(e);t.blockingActions.add(new b(t,this.idGenerator));for(let i of Vt)t.actions.add(new i(t,this));this.tabs.set(e.id,t),chrome.tabs.update(e.id,{autoDiscardable:!1}),t.start()}},Vt=[z,X,G,H,V];globalThis.__BACKGROUND__=new Q;})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)
*/
